webpackJsonp([0],{66:function(e,t,a){var n=a(67);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(13).default)("79f5523c",n,!0,{})},67:function(e,t,a){(e.exports=a(1)(!1)).push([e.i,".vertical-center-modal{display:flex;align-items:center;justify-content:center}.vertical-center-modal .ivu-modal{top:0}",""])},68:function(e,t,a){var n=a(69);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(13).default)("1e623d02",n,!0,{})},69:function(e,t,a){(e.exports=a(1)(!1)).push([e.i,".mark-poptip p[data-v-64f929be]{padding:2.5px 0}",""])},79:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={mounted:function(){},props:{job_id:{default:0,type:Number}},methods:{markSuccess:function(){var e=this;this.$http.put("/jobs/mark/success/"+this.job_id).then(function(t){e.$Message.success("操作成功"),e.$emit("statusUpdated")})},markFail:function(){var e=this;this.$http.put("/jobs/mark/fail/"+this.job_id).then(function(t){e.$Message.success("操作成功"),e.$emit("statusUpdated")})},markClose:function(){var e=this;this.$http.put("/jobs/mark/close/"+this.job_id).then(function(t){e.$Message.success("操作成功"),e.$emit("statusUpdated")})}}},i=a(12);var o=function(e){a(68)},s=Object(i.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Poptip",{attrs:{placement:"right"}},[a("Button",{staticStyle:{color:"#ff9900"},attrs:{type:"text",size:"small"}},[e._v("mark")]),e._v(" "),a("div",{staticClass:"mark-poptip",attrs:{slot:"content"},slot:"content"},[a("p",[a("Button",{attrs:{type:"success",size:"small",icon:"happy-outline"},on:{click:e.markSuccess}},[e._v("成功")])],1),e._v(" "),a("p",[a("Button",{attrs:{type:"default",size:"small",icon:"sad-outline"},on:{click:e.markFail}},[e._v("失败")])],1),e._v(" "),a("p",[a("Button",{attrs:{type:"default",size:"small",icon:"ios-close"},on:{click:e.markClose}},[e._v("关闭")])],1)])],1)},[],!1,o,"data-v-64f929be",null).exports,l={mounted:function(){this.getListData(),this.getClientListData(),this.getCandidateListData()},created:function(){},data:function(){var e=this;return{addModel:!1,addModelLoading:!0,formValidate:{client_id:"",name:"",remark:""},ruleValidate:{client_id:[{required:!0,message:"请选择职位所属客户",trigger:"change"}],name:[{required:!0,message:"客户名称不能为空",trigger:"blur"}]},listQuery:{page:1,limits:10},pageData:{current_page:1,last_page:0,per_page:10,total:0},columns:[{title:"#",render:function(t,a){return t("span",e.getListIndex(a.index))}},{title:"职位名称",key:"name"},{title:"所属客户",key:"client_name"},{title:"创建时间",key:"created_at",minWidth:150},{title:"职位状态",key:"status",render:function(t,a){return e.getStatusContent(t,a)}},{title:"已推数",key:"recommend_number"},{title:"操作",minWidth:250,render:function(t,a){return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"#19be6b"},on:{click:function(){e.showRecommendModel(a.row.id)}}},"推荐"),t(s,{props:{job_id:a.row.id},on:{statusUpdated:function(){e.getListData()}}}),t("Button",{props:{type:"text",size:"small"},style:{color:"#19be6b"},on:{click:function(){e.goClientDetail(a.row.id)}}},"详情"),t("Button",{props:{type:"text",size:"small"},style:{color:"#ff9900"}},"修改")])}}],data:[],clients:[],recommendValidate:{candidate_id:[],job_id:null},recommendRuleValidate:{candidate_id:[{required:!0,type:"array",min:1,message:"请选择至少一个人选",trigger:"change"}]},recommendModel:!1,recommendModelLoading:!0,candidateList:[]}},methods:{getListData:function(){var e=this;this.$http.get("/jobs",{params:this.listQuery}).then(function(t){e.data=t.data.data,e.pageData=t.data.meta})},getClientListData:function(){var e=this;this.$http.get("/clients",{params:{page:1,limits:1e4}}).then(function(t){e.clients=t.data.data})},getListIndex:function(e){return(this.pageData.current_page-1)*this.pageData.per_page+e+1},getCandidateListData:function(){var e=this;this.$http.get("/candidates",{params:{page:1,limits:1e4}}).then(function(t){e.candidateList=e.handleFormatCandidateListData(t.data.data),console.log(e.candidateList)})},handleFormatCandidateListData:function(e){var t=[];return e.length>0&&e.forEach(function(e){var a=e.name_mobile;e.current_job&&(a+="-"+e.current_job),e.current_company&&(a+="-"+e.current_company),e.education&&(a+="-"+e.education),e.school&&(a+="-"+e.school),t.push({value:e.id,label:a})}),t},handlePageChange:function(e){this.listQuery.page=e,this.getListData()},handlePageSizeChange:function(e){this.listQuery.limits=e,this.getListData()},showAddModel:function(){this.addModel=!0},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e?t.$http.post("/jobs",t.formValidate).then(function(e){t.$Message.success("添加成功"),t.addModelLoading=!1,t.addModel=!1,t.$refs.formValidate.resetFields(),t.listQuery.page=1,t.getListData()}).catch(function(e){t.addModelLoading=!1}):t.addModelLoading=!1})},goClientDetail:function(e){this.$router.push({name:"hunter.client.detail",params:{id:e}})},getStatusContent:function(e,t){var a=t.row.status,n=void 0;return 1==a?n=e("div",[e("Button",{props:{type:"text",size:"small",icon:"ios-search"},style:{color:"#ed3f14"}},"寻找中...")]):2==a?n=e("div",[e("Button",{props:{type:"text",size:"small",icon:"android-chat"},style:{color:"#ff9900"}},"已推荐")]):3==a?n=e("div",[e("Button",{props:{type:"text",size:"small",icon:"sad-outline"},style:{color:"#bbbec4"}},"失败")]):4==a?n=e("div",[e("Button",{props:{type:"text",size:"small",icon:"happy-outline"},style:{color:"#19be6b"}},"推荐成功")]):5==a&&(n=e("div",[e("Button",{props:{type:"text",size:"small",icon:"ios-close"},style:{color:"#bbbec4"}},"已关闭")])),n},handleRecommendSubmit:function(e){var t=this;console.log(this.recommendValidate),this.$refs[e].validate(function(a){a?t.$http.post("/recommends",t.recommendValidate).then(function(a){t.$Message.success("添加成功"),t.recommendModelLoading=!1,t.recommendModel=!1,t.$refs[e].resetFields(),t.listQuery.page=1,t.getListData()}).catch(function(e){t.recommendModelLoading=!1}):t.recommendModelLoading=!1})},showRecommendModel:function(e){this.recommendModel=!0,this.recommendValidate.job_id=e},handleRecommendCancel:function(e){this.$refs[e].resetFields()}}};var d=function(e){a(66)},r=Object(i.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",[a("Tabs",{attrs:{value:"name1"}},[a("TabPane",{attrs:{label:"职位管理",name:"name1"}},[a("Table",{attrs:{columns:e.columns,data:e.data,size:"small"}}),e._v(" "),a("div",{staticClass:"page"},[a("Page",{attrs:{total:parseInt(e.pageData.total),"page-size":parseInt(e.pageData.per_page),current:parseInt(e.pageData.current_page),size:"small",placement:"top","page-size-opts":[10,20,30,50,100],"show-elevator":"","show-sizer":""},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange}})],1)],1),e._v(" "),a("Button",{attrs:{slot:"extra",type:"success",icon:"ios-personadd",size:"small"},on:{click:e.showAddModel},slot:"extra"},[e._v("新增职位")])],1)],1),e._v(" "),a("Modal",{attrs:{title:"新增职位","class-name":"vertical-center-modal","ok-text":"提交",loading:e.addModelLoading},on:{"on-ok":function(t){e.handleSubmit("formValidate")}},model:{value:e.addModel,callback:function(t){e.addModel=t},expression:"addModel"}},[a("div",[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"所属客户",prop:"client_id"}},[a("Select",{attrs:{placeholder:"选择客户(可输入名称搜索)",filterable:""},model:{value:e.formValidate.client_id,callback:function(t){e.$set(e.formValidate,"client_id",t)},expression:"formValidate.client_id"}},e._l(e.clients,function(t){return a("Option",{key:t.id,attrs:{value:t.id+""},domProps:{innerHTML:e._s(t.name)}},[e._v("New York")])}))],1),e._v(" "),a("FormItem",{attrs:{label:"职位名称",prop:"name"}},[a("Input",{attrs:{placeholder:"职位名称"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"备注",prop:"remark"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter something..."},model:{value:e.formValidate.remark,callback:function(t){e.$set(e.formValidate,"remark",t)},expression:"formValidate.remark"}})],1)],1)],1)]),e._v(" "),a("Modal",{attrs:{title:"职位推荐","class-name":"vertical-center-modal","ok-text":"提交",loading:e.recommendModelLoading},on:{"on-ok":function(t){e.handleRecommendSubmit("recommendValidate")},"on-cancel":function(t){e.handleRecommendCancel("recommendValidate")}},model:{value:e.recommendModel,callback:function(t){e.recommendModel=t},expression:"recommendModel"}},[a("div",[a("Form",{ref:"recommendValidate",attrs:{model:e.recommendValidate,rules:e.recommendRuleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"人选",prop:"candidate_id"}},[a("Select",{attrs:{filterable:"",multiple:""},model:{value:e.recommendValidate.candidate_id,callback:function(t){e.$set(e.recommendValidate,"candidate_id",t)},expression:"recommendValidate.candidate_id"}},e._l(e.candidateList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1)],1)])],1)},[],!1,d,null,null);t.default=r.exports}});